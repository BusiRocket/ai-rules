---
description: Laravel standards (framework-native validation, authz, queues, and API boundaries)
globs: "app/**/*.php,bootstrap/**/*.php,routes/**/*.php,config/**/*.php,database/**/*.php,tests/**/*.php"
alwaysApply: true
---

# Laravel Standards

## Platform constraints

- Prefer current stable Laravel major supported by the project (Laravel 12+ in modern projects).
- Prefer PHP 8.2+ (8.3+ when compatible with dependencies and hosting).

## Architecture

- Controllers should be thin orchestration layers.
- Keep business logic in services/actions/domain classes.
- Use constructor DI/method injection over static facades in core business paths.
- Use repositories only when persistence complexity justifies the extra layer.

## Framework-native primitives

- Validation: Form Requests.
- Authorization: Policies/Gates.
- Background jobs: Queues/Jobs (Horizon when available).
- Response shaping: API Resources.
- Decoupling: Events/Listeners where useful.

## Data and persistence

- Use Eloquent for standard CRUD and relationships.
- Use Query Builder when complex SQL is clearer than Eloquent chains.
- Use `DB::transaction()` for multi-step data integrity.
- Keep migrations reversible and indexed intentionally.

## Security and reliability

- Keep CSRF enabled for state-changing web flows.
- Rate-limit public endpoints where abuse is possible.
- Never expose secrets in responses/logs.
- Use signed URLs for sensitive temporary links where appropriate.

## Testing

- Unit + feature tests with PHPUnit/Pest.
- Use factories and isolated test databases.
- Add browser/E2E tests only for critical end-user flows.
